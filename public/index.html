<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>To-Do List</title>
  <style>
    /* your styles here */
    body { font-family: Arial, sans-serif; background: #f4f6f8; margin:0; padding:0; display:flex; justify-content:center; align-items:flex-start; min-height:100vh; }
    .container {background:#fff; margin-top:50px; padding:30px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1); width:100%; max-width:600px;}
    h1 { text-align:center; color:#333; margin-bottom:20px;}
    .task-input { display:flex; gap:10px; margin-bottom:20px; }
    #taskInput { flex:1; padding:12px; border:1px solid #ddd; border-radius:8px; font-size:16px; }
    .btn-add { background:#0078d7; color:white; border:none; padding:10px 16px; border-radius:8px; cursor:pointer; }
    ul { list-style:none; padding:0; margin:0; }
    li { background:#f9f9f9; margin-bottom:10px; padding:12px; border-radius:8px; display:flex; justify-content:space-between; align-items:center; border:1px solid #eee; }
    li.completed { text-decoration:line-through; color:gray; background:#e9ecef; }
    .btn-complete { background:#28a745; color:white; border:none; padding:6px; border-radius:6px; margin-left:5px; cursor:pointer; }
    .btn-delete { background:#dc3545; color:white; border:none; padding:6px; border-radius:6px; margin-left:5px; cursor:pointer; }
    .nav-links { margin-top:20px; text-align:center; }
    .nav-links a { color:#0078d7; text-decoration:none; margin:0 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>✅ To-Do List</h1>
    <div class="task-input">
      <input id="taskInput" placeholder="Add a new task..." />
      <button class="btn-add" onclick="addTask()">Add</button>
    </div>
    <ul id="taskList"></ul>
    <div class="nav-links">
      <a href="completed.html">View Completed Tasks</a> | <a href="deleted.html">View Deleted Tasks</a>
    </div>
  </div>
  <script>
    const API_BASE = "/api/server";

    async function fetchTasks() {
      try {
        const res = await fetch(`${API_BASE}/tasks`);
        const tasks = await res.json();
        const list = document.getElementById("taskList");
        list.innerHTML = "";
        tasks.forEach(t => {
          const li = document.createElement("li");
          li.className = t.completed ? "completed" : "";
          let inner = `<span>${t.task}${t.completed ? " ✅" : ""}</span><div>`;
          if (!t.completed) {
            inner += `<button class="btn-complete" onclick="completeTask(${t.id})">Complete</button>`;
          }
          inner += `<button class="btn-delete" onclick="deleteTask(${t.id})">Delete</button></div>`;
          li.innerHTML = inner;
          list.appendChild(li);
        });
      } catch (err) {
        console.error("Error fetching tasks:", err);
      }
    }

    async function addTask() {
      const input = document.getElementById("taskInput");
      const task = input.value.trim();
      if (!task) return alert("Enter a task");
      try {
        await fetch(`${API_BASE}/tasks`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ task })
        });
        input.value = "";
        fetchTasks();
      } catch (err) {
        console.error("Error adding task:", err);
      }
    }

    async function completeTask(id) {
      await fetch(`${API_BASE}/tasks/${id}`, { method: "PUT" });
      fetchTasks();
    }

    async function deleteTask(id) {
      await fetch(`${API_BASE}/tasks/${id}`, { method: "DELETE" });
      fetchTasks();
    }

    fetchTasks();
  </script>
</body>
</html>
